# apply multiple testing correction using Benjamini-Hochberg method for FDR
pvals$padj <- p.adjust(pvals$pval,"BH")
source('~/Downloads/Benedetti_NatCommun/ResultsReplication.R')
source('~/Downloads/Benedetti_NatCommun/ResultsReplication.R')
library(dplyr)
source('~/Downloads/Benedetti_NatCommun/ResultsReplication.R')
p
# compute contingency table
contin <- contab(adja, adja_data)
contin
# compute Fisher's exact test p-value (cfr. Figure 5B for the selected model)
fis <- fisher.test(contin)
fis$p.value
head(pcor)
pcor
heatmap.2(pcor)
library(gplots)
heatmap.2(pcor)
heatmap.2(pcor,trace='none')
heatmap.2(pcor,trace='none',col=cm.colors())
heatmap.2(pcor,trace='none',col=cm.colors
)
adja[adja==1]
head(adja)
# load preprocessed glycomics data
df <- as.data.frame(read_excel(path="SupplementalMaterial_DatasetS1_PreprocessedData.xls",sheet="Kor훾ula2013_residuals",col_names=T))
data <- df[,2:dim(df)[2]]
rownames(data) <- df[,1]
# load prior knowledge adjacency matrix (inferred pathway in our paper)
adja <- read.csv("InferredPathway.csv", header = TRUE, sep = ";", dec = ",", row.names = 1)
adja[is.na(adja)] <- 0
# compute partial correlation using GeneNet
pcor <- ggm.estimate.pcor(as.matrix(data), method = "dynamic")
# compute associated p-values
pvals <- network.test.edges(pcor)
# apply multiple testing correction using Benjamini-Hochberg method for FDR
pvals$padj <- p.adjust(pvals$pval,"BH")
# get correlation cutoff for GGM
pvals$pval[pvals$pval > 0.01] <- NaN
fdr_threshold <- abs(pvals$pcor[which.max(pvals$pval)])
pd1 <- pcor[adja==1]
pd1 <- pd1[!is.na(pd1)]
p <- data.frame(pcor=pd1) %>%
ggplot(aes(x="",y=pcor)) +
geom_boxplot() +
geom_jitter(shape=16, position=position_jitter(0.2)) +
ylim(-1,1) +
geom_hline(yintercept = fdr_threshold, color = "gray50", linetype = 2) +
geom_hline(yintercept = - fdr_threshold, color = "gray50", linetype = 2) +
theme_bw() +
xlab("Pathway Distance 1") +
ylab("Partial Correlation Coefficients") +
ggtitle("Distribution of Coefficients at Pathway Distance 1")
p
head(adja[,1:10])
sum(adja)
# load preprocessed glycomics data
df <- as.data.frame(read_excel(path="SupplementalMaterial_DatasetS1_PreprocessedData.xls",sheet="Kor훾ula2013_residuals",col_names=T))
data <- df[,2:dim(df)[2]]
rownames(data) <- df[,1]
str(data)
head(data)
setwd("/home/ben/Desktop/croatia_ppcor/Benedetti_NatCommun/")
data = read.csv('../data-final/k2010.motifs.csv')
head(data)
str(data)
# load preprocessed glycomics data
#df <- as.data.frame(read_excel(path="SupplementalMaterial_DatasetS1_PreprocessedData.xls",sheet="Kor훾ula2013_residuals",col_names=T))
#data <- df[,2:dim(df)[2]]
#rownames(data) <- df[,1]
data = read.csv('../data-final/k2010.motifs.csv')
# load prior knowledge adjacency matrix (inferred pathway in our paper)
adja <- read.csv("InferredPathway.csv", header = TRUE, sep = ";", dec = ",", row.names = 1)
adja[is.na(adja)] <- 0
# compute partial correlation using GeneNet
pcor <- ggm.estimate.pcor(as.matrix(data), method = "dynamic")
all(colnames(adja)==colnames(data))
# load preprocessed glycomics data
df <- as.data.frame(read_excel(path="SupplementalMaterial_DatasetS1_PreprocessedData.xls",sheet="Kor훾ula2013_residuals",col_names=T))
data <- df[,2:dim(df)[2]]
rownames(data) <- df[,1]
# load preprocessed glycomics data
df <- as.data.frame(read_excel(path="SupplementalMaterial_DatasetS1_PreprocessedData.xls",sheet="k_2013_residuals",col_names=T))
data <- df[,2:dim(df)[2]]
rownames(data) <- df[,1]
# load prior knowledge adjacency matrix (inferred pathway in our paper)
adja <- read.csv("InferredPathway.csv", header = TRUE, sep = ";", dec = ",", row.names = 1)
adja[is.na(adja)] <- 0
all(colnames(data)==all(colnames(adja)))
colname(data)
colnames(data)
all(colnames(data)==colnames(colnames(adja)))
pd1
head(melt(pcor))
library(reshape2)
head(melt(pcor))
str(pcor)
as.matrix(pcor)
heatmap.2(pcor,trace='none')
heatmap.2(pcor,trace='none',col=cm.colors)
heatmap.2(matrix(as.numeric(pcor),nrow=nrow(pcor),ncol=ncol(pcor)),trace='none',col=cm.colors)
heatmap.2(pcor,trace='none',col=cm.colors)
